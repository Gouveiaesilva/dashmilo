<!DOCTYPE html>
<html class="dark" lang="pt-BR">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0, viewport-fit=cover, user-scalable=no" name="viewport"/>
    <meta name="apple-mobile-web-app-capable" content="yes"/>
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/>
    <meta name="theme-color" content="#0a0f14"/>
    <title>Milo MKT | Painel Gerencial Meta Ads</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>

    <!-- jsPDF para geracao de relatorios -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <script src="script.js"></script>
    <script src="report.js" defer></script>
    <script src="macro-analysis.js" defer></script>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&amp;display=swap" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap" rel="stylesheet"/>

    <!-- Custom CSS -->
    <link href="style.css" rel="stylesheet"/>

    <!-- Favicon -->
    <link rel="icon" type="image/jpeg" href="img/logo.jpg"/>
</head>
<body class="bg-background-dark text-slate-300 min-h-screen flex overflow-hidden">

<!-- Tela de Login -->
<div id="loginScreen" class="fixed inset-0 z-[100] bg-background-dark flex items-center justify-center p-4">
    <div class="w-full max-w-md">
        <!-- Logo e Titulo -->
        <div class="text-center mb-8">
            <img src="img/logo.jpg" alt="Logo" class="w-20 h-20 rounded-2xl mx-auto mb-4 shadow-lg object-cover"/>
            <h1 class="text-2xl font-bold text-white tracking-tight">Painel Gerencial Meta Ads</h1>
            <p class="text-slate-500 text-sm mt-2">Gerencie suas campanhas de anuncios</p>
        </div>

        <!-- Card de Login -->
        <div class="bg-surface-dark border border-border-dark rounded-2xl p-6 sm:p-8 shadow-2xl">
            <h2 class="text-lg font-bold text-white mb-6 text-center">Entrar na sua conta</h2>

            <form id="loginForm" onsubmit="handleLogin(event)" class="space-y-4">
                <!-- Email -->
                <div>
                    <label class="block text-xs font-medium text-slate-400 mb-2">Email</label>
                    <div class="relative">
                        <span class="material-symbols-outlined absolute left-3 top-1/2 -translate-y-1/2 text-slate-500 text-xl">mail</span>
                        <input
                            type="email"
                            id="loginEmail"
                            class="w-full bg-background-dark border border-border-dark text-white rounded-lg py-3 pl-11 pr-4 text-sm focus:ring-2 focus:ring-primary focus:border-primary transition-colors"
                            placeholder="seu@email.com"
                            required
                        >
                    </div>
                </div>

                <!-- Senha -->
                <div>
                    <label class="block text-xs font-medium text-slate-400 mb-2">Senha</label>
                    <div class="relative">
                        <span class="material-symbols-outlined absolute left-3 top-1/2 -translate-y-1/2 text-slate-500 text-xl">lock</span>
                        <input
                            type="password"
                            id="loginPassword"
                            class="w-full bg-background-dark border border-border-dark text-white rounded-lg py-3 pl-11 pr-12 text-sm focus:ring-2 focus:ring-primary focus:border-primary transition-colors"
                            placeholder="Digite sua senha"
                            required
                        >
                        <button
                            type="button"
                            onclick="toggleLoginPasswordVisibility()"
                            class="absolute right-3 top-1/2 -translate-y-1/2 text-slate-500 hover:text-white transition-colors"
                        >
                            <span class="material-symbols-outlined text-xl" id="loginPasswordToggleIcon">visibility</span>
                        </button>
                    </div>
                </div>

                <!-- Erro de login -->
                <p id="loginError" class="text-red-500 text-xs hidden">Email ou senha incorretos.</p>

                <!-- Botao Login -->
                <button
                    type="submit"
                    class="w-full py-3 px-4 bg-primary text-white rounded-lg text-sm font-bold hover:bg-primary/90 transition-colors flex items-center justify-center gap-2 mt-2"
                >
                    <span>Entrar</span>
                    <span class="material-symbols-outlined text-lg">arrow_forward</span>
                </button>
            </form>

        </div>

        <!-- Footer -->
        <p class="text-center text-xs text-slate-600 mt-6">
            Ao entrar, voce concorda com nossos <a href="#" class="text-slate-400 hover:text-white">Termos</a> e <a href="#" class="text-slate-400 hover:text-white">Privacidade</a>
        </p>
    </div>
</div>

<!-- Dashboard Container (inicialmente oculto) -->
<div id="dashboardContainer" class="hidden contents">

<!-- Overlay para fechar sidebar no mobile -->
<div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>

<aside class="sidebar w-64 border-r border-border-dark flex flex-col shrink-0 bg-background-dark lg:relative lg:translate-x-0" id="sidebar">
    <div class="p-4 sm:p-6">
        <div class="flex items-center justify-between gap-3">
            <div class="flex items-center gap-3">
                <img src="img/logo.jpg" alt="Logo" class="w-9 h-9 rounded-lg object-cover"/>
                <span class="text-lg sm:text-xl font-bold text-white tracking-tight">Milo MKT</span>
            </div>
            <!-- Botao fechar sidebar no mobile -->
            <button class="lg:hidden p-1 text-slate-400 hover:text-white transition-colors" onclick="toggleSidebar()">
                <span class="material-symbols-outlined">close</span>
            </button>
        </div>
    </div>
    <nav class="flex-1 mt-4">
        <div class="px-4 mb-2 text-xs font-semibold text-slate-500 uppercase tracking-widest">Geral</div>
        <a id="navVisaoGeral" class="flex items-center gap-3 px-6 py-3 text-sm font-medium sidebar-item-active transition-colors cursor-pointer" onclick="switchPanel('visao-geral')">
            <span class="material-symbols-outlined" style="font-variation-settings: 'FILL' 1;">grid_view</span>
            Visao Geral
        </a>
        <a id="navMetricas" class="flex items-center gap-3 px-6 py-3 text-sm font-medium text-slate-400 hover:text-white transition-colors cursor-pointer" onclick="switchPanel('metricas')">
            <span class="material-symbols-outlined">dashboard</span>
            Metricas
        </a>
        <a class="flex items-center gap-3 px-6 py-3 text-sm font-medium text-slate-500 cursor-not-allowed" href="#">
            <span class="material-symbols-outlined">ads_click</span>
            Campanhas <span class="text-[10px] text-slate-600 ml-1">(Em breve)</span>
        </a>
        <a id="navRelatorios" class="flex items-center gap-3 px-6 py-3 text-sm font-medium text-slate-400 hover:text-white transition-colors cursor-pointer" onclick="switchPanel('relatorios')">
            <span class="material-symbols-outlined">description</span>
            Relatorios
        </a>
        <a class="flex items-center gap-3 px-6 py-3 text-sm font-medium hover:text-white transition-colors cursor-pointer" onclick="openPasswordModal()">
            <span class="material-symbols-outlined">settings</span>
            Ajustes
        </a>
    </nav>
    <div class="p-6 border-t border-border-dark">
        <div class="flex items-center gap-3 p-2 bg-surface-dark rounded-lg">
            <div class="w-8 h-8 rounded-full bg-primary/20 flex items-center justify-center">
                <span id="userAvatar" class="text-primary text-sm font-bold">U</span>
            </div>
            <div class="flex-1 overflow-hidden">
                <p id="userName" class="text-xs font-bold text-white truncate">Usuario</p>
                <p id="userRole" class="text-[10px] text-slate-500 truncate">Usuario</p>
            </div>
            <button onclick="handleLogout()" class="p-1.5 rounded-lg text-slate-500 hover:text-white hover:bg-red-500/20 transition-colors" title="Sair">
                <span class="material-symbols-outlined text-lg">logout</span>
            </button>
        </div>
    </div>
</aside>

<main class="flex-1 flex flex-col overflow-y-auto bg-background-dark">

    <!-- Header Visao Geral (visivel por padrao) -->
    <header id="headerVisaoGeral" class="sticky top-0 z-30 bg-background-dark/95 backdrop-blur-md border-b border-border-dark">
        <div class="max-w-7xl mx-auto">
            <div class="flex items-center justify-between gap-4 px-4 sm:px-6 py-3 sm:py-4">
                <div class="flex items-center gap-3">
                    <button class="menu-toggle lg:hidden p-2 -ml-2 text-slate-400 hover:text-white transition-colors" onclick="toggleSidebar()">
                        <span class="material-symbols-outlined text-2xl">menu</span>
                    </button>
                    <div class="min-w-0">
                        <h1 class="text-base sm:text-xl font-bold text-white truncate">Visao Geral</h1>
                        <p class="text-[11px] sm:text-xs text-slate-500 truncate">Panorama de todos os clientes</p>
                    </div>
                </div>
                <div class="flex items-center gap-2 shrink-0">
                    <div class="flex items-center bg-surface-dark border border-border-dark rounded-lg p-0.5">
                        <button id="viewBoard" onclick="setOverviewView('board')" title="Visualizacao em lista"
                            class="p-1.5 rounded-md transition-colors text-white bg-primary/20">
                            <span class="material-symbols-outlined text-lg">view_list</span>
                        </button>
                        <button id="viewCards" onclick="setOverviewView('cards')" title="Visualizacao em cards"
                            class="p-1.5 rounded-md transition-colors text-slate-500 hover:text-slate-300">
                            <span class="material-symbols-outlined text-lg">grid_view</span>
                        </button>
                    </div>
                    <button onclick="openDateFilterModal()" class="flex items-center gap-1.5 px-2.5 sm:px-3 py-2 bg-surface-dark border border-border-dark rounded-lg text-xs sm:text-sm font-medium text-slate-300 hover:bg-slate-800 transition-colors">
                        <span class="material-symbols-outlined text-base">calendar_today</span>
                        <span id="overviewDateLabel" class="hidden sm:inline">Ultimos 7 dias</span>
                        <span class="material-symbols-outlined text-base text-slate-500">expand_more</span>
                    </button>
                    <button onclick="loadOverviewData()" class="p-2 bg-primary text-white rounded-lg hover:bg-primary/90 transition-colors" title="Atualizar dados">
                        <span class="material-symbols-outlined text-xl">refresh</span>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Header Metricas (oculto por padrao) -->
    <header id="headerMetricas" class="hidden sticky top-0 z-30 bg-background-dark/95 backdrop-blur-md border-b border-border-dark">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 py-3 sm:py-4">
            <div class="flex items-center justify-between gap-3">
                <!-- Esquerda: Menu + Titulo -->
                <div class="flex items-center gap-3 min-w-0">
                    <button class="menu-toggle lg:hidden p-2 -ml-2 text-slate-400 hover:text-white transition-colors" onclick="toggleSidebar()">
                        <span class="material-symbols-outlined text-2xl">menu</span>
                    </button>
                    <div class="min-w-0">
                        <h1 class="text-base sm:text-xl font-bold text-white truncate">Metricas</h1>
                        <p id="selectedClientName" class="text-[11px] sm:text-xs text-slate-500 truncate">Selecione um cliente</p>
                    </div>
                </div>

                <!-- Direita: Filtros + Acoes -->
                <div class="flex items-center gap-1.5 sm:gap-2 overflow-x-auto hide-scrollbar">
                    <!-- Filtros agrupados -->
                    <div class="flex items-center gap-1.5 bg-surface-dark/50 border border-border-dark/50 rounded-xl p-1 shrink-0">
                        <!-- Cliente -->
                        <div class="relative">
                            <span class="material-symbols-outlined absolute left-2 top-1/2 -translate-y-1/2 text-slate-500 pointer-events-none text-sm">person</span>
                            <select id="clientFilter" onchange="onClientFilterChange()" class="bg-transparent border-0 text-slate-300 rounded-lg py-1.5 pl-7 pr-6 text-xs appearance-none focus:ring-1 focus:ring-primary hover:bg-surface-dark transition-colors cursor-pointer max-w-[130px] sm:max-w-[170px]">
                                <option value="">Cliente</option>
                            </select>
                            <span class="material-symbols-outlined absolute right-1 top-1/2 -translate-y-1/2 text-slate-600 pointer-events-none text-xs">expand_more</span>
                        </div>

                        <div class="w-px h-5 bg-border-dark/60"></div>

                        <!-- Campanha -->
                        <div class="relative hidden sm:block">
                            <span class="material-symbols-outlined absolute left-2 top-1/2 -translate-y-1/2 text-slate-500 pointer-events-none text-sm">campaign</span>
                            <select id="campaignFilter" onchange="onCampaignFilterChange()" class="bg-transparent border-0 text-slate-300 rounded-lg py-1.5 pl-7 pr-6 text-xs appearance-none focus:ring-1 focus:ring-primary hover:bg-surface-dark transition-colors cursor-pointer max-w-[150px] disabled:opacity-30" disabled>
                                <option value="">Campanhas</option>
                            </select>
                            <span class="material-symbols-outlined absolute right-1 top-1/2 -translate-y-1/2 text-slate-600 pointer-events-none text-xs">expand_more</span>
                        </div>

                        <div class="w-px h-5 bg-border-dark/60 hidden lg:block"></div>

                        <!-- Conjunto -->
                        <div class="relative hidden lg:block">
                            <span class="material-symbols-outlined absolute left-2 top-1/2 -translate-y-1/2 text-slate-500 pointer-events-none text-sm">account_tree</span>
                            <select id="adsetFilter" onchange="onAdsetFilterChange()" class="bg-transparent border-0 text-slate-300 rounded-lg py-1.5 pl-7 pr-6 text-xs appearance-none focus:ring-1 focus:ring-primary hover:bg-surface-dark transition-colors cursor-pointer max-w-[150px] disabled:opacity-30" disabled>
                                <option value="">Conjuntos</option>
                            </select>
                            <span class="material-symbols-outlined absolute right-1 top-1/2 -translate-y-1/2 text-slate-600 pointer-events-none text-xs">expand_more</span>
                        </div>
                    </div>

                    <!-- Periodo -->
                    <button onclick="openDateFilterModal()" class="flex items-center gap-1.5 px-2.5 sm:px-3 py-1.5 bg-surface-dark border border-border-dark rounded-lg text-xs font-medium hover:border-slate-600 transition-colors shrink-0">
                        <span class="material-symbols-outlined text-sm text-primary">calendar_today</span>
                        <span id="dateFilterLabel" class="hidden md:inline text-slate-300">Ultimos 7 dias</span>
                        <span id="dateFilterLabelMobile" class="md:hidden text-slate-300">7d</span>
                        <span class="material-symbols-outlined text-xs text-slate-500">expand_more</span>
                    </button>

                    <!-- Acoes -->
                    <div class="flex items-center gap-1 shrink-0">
                        <button onclick="clearAllFilters()" class="p-1.5 text-slate-500 hover:text-white hover:bg-surface-dark rounded-lg transition-colors" title="Limpar filtros">
                            <span class="material-symbols-outlined text-lg">filter_alt_off</span>
                        </button>
                        <button class="p-1.5 bg-primary text-white rounded-lg hover:bg-primary/90 transition-colors" title="Atualizar dados">
                            <span class="material-symbols-outlined text-lg">refresh</span>
                        </button>
                        <button id="sendReportBtn" onclick="sendManualReport()" class="hidden p-1.5 text-slate-500 hover:text-primary hover:bg-primary/10 rounded-lg transition-colors" title="Enviar relatorio para Google Chat">
                            <span class="material-symbols-outlined text-lg">send</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Header Relatorios (oculto por padrao) -->
    <header id="headerRelatorios" class="hidden sticky top-0 z-30 bg-background-dark/95 backdrop-blur-md border-b border-border-dark">
        <div class="max-w-7xl mx-auto">
            <div class="flex items-center justify-between gap-4 px-4 sm:px-6 py-3 sm:py-4">
                <div class="flex items-center gap-3">
                    <button class="menu-toggle lg:hidden p-2 -ml-2 text-slate-400 hover:text-white transition-colors" onclick="toggleSidebar()">
                        <span class="material-symbols-outlined text-2xl">menu</span>
                    </button>
                    <div class="min-w-0">
                        <h1 class="text-base sm:text-xl font-bold text-white truncate">Relatorios</h1>
                        <p class="text-[11px] sm:text-xs text-slate-500 truncate">Gere relatorios em PDF para seus clientes</p>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Estado de Loading (overlay) -->
    <div id="loadingState" class="hidden fixed inset-0 z-40 bg-background-dark/80 backdrop-blur-sm flex items-center justify-center">
        <div class="text-center bg-surface-dark border border-border-dark rounded-2xl p-8 shadow-2xl">
            <div class="w-12 h-12 border-4 border-primary/20 border-t-primary rounded-full animate-spin mx-auto mb-4"></div>
            <p class="text-sm text-slate-400">Carregando dados...</p>
        </div>
    </div>

    <!-- Painel: Visao Geral (visivel por padrao) -->
    <div id="panelVisaoGeral" class="p-4 sm:p-6 lg:p-8 space-y-6 sm:space-y-8 max-w-7xl mx-auto w-full">
        <!-- KPI Cards Premium -->
        <div class="grid grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4">
            <!-- Investimento Total -->
            <div class="bg-surface-dark border border-border-dark rounded-xl sm:rounded-2xl p-4 sm:p-5 shadow-sm">
                <div class="flex items-center justify-between mb-2">
                    <div class="w-8 h-8 bg-blue-500/10 rounded-lg flex items-center justify-center text-blue-500">
                        <span class="material-symbols-outlined text-xl">payments</span>
                    </div>
                    <div id="overviewSpendTrend" class="text-[10px] font-bold text-slate-500">--</div>
                </div>
                <span class="text-[9px] sm:text-[10px] font-bold text-slate-500 uppercase tracking-widest">Investimento Total</span>
                <p id="overviewTotalSpend" class="text-lg sm:text-xl font-bold text-white mt-0.5">--</p>
            </div>

            <!-- Leads Totais -->
            <div class="bg-surface-dark border border-border-dark rounded-xl sm:rounded-2xl p-4 sm:p-5 shadow-sm">
                <div class="flex items-center justify-between mb-2">
                    <div class="w-8 h-8 bg-emerald-500/10 rounded-lg flex items-center justify-center text-emerald-500">
                        <span class="material-symbols-outlined text-xl">person_add</span>
                    </div>
                    <div id="overviewLeadsTrend" class="text-[10px] font-bold text-slate-500">--</div>
                </div>
                <span class="text-[9px] sm:text-[10px] font-bold text-slate-500 uppercase tracking-widest">Total de Leads</span>
                <p id="overviewTotalLeads" class="text-lg sm:text-xl font-bold text-white mt-0.5">--</p>
            </div>

            <!-- CPL Medio -->
            <div class="bg-surface-dark border border-border-dark rounded-xl sm:rounded-2xl p-4 sm:p-5 shadow-sm">
                <div class="flex items-center justify-between mb-2">
                    <div class="w-8 h-8 bg-purple-500/10 rounded-lg flex items-center justify-center text-purple-500">
                        <span class="material-symbols-outlined text-xl">toll</span>
                    </div>
                    <div id="overviewCplTrend" class="text-[10px] font-bold text-slate-500">--</div>
                </div>
                <span class="text-[9px] sm:text-[10px] font-bold text-slate-500 uppercase tracking-widest">CPL Medio</span>
                <p id="overviewAvgCpl" class="text-lg sm:text-xl font-bold text-white mt-0.5">--</p>
            </div>

            <!-- Status das Contas -->
            <div class="bg-surface-dark border border-border-dark rounded-xl sm:rounded-2xl p-4 sm:p-5 shadow-sm">
                <div class="flex items-center justify-between mb-2">
                    <div class="w-8 h-8 bg-primary/10 rounded-lg flex items-center justify-center text-primary">
                        <span class="material-symbols-outlined text-xl">monitor_heart</span>
                    </div>
                </div>
                <span class="text-[9px] sm:text-[10px] font-bold text-slate-500 uppercase tracking-widest">Contas</span>
                <div class="flex items-center gap-3 mt-1">
                    <span id="overviewTotalClients" class="text-lg sm:text-xl font-bold text-white">--</span>
                    <div class="flex items-center gap-2 text-xs">
                        <span class="flex items-center gap-1"><span class="w-2 h-2 rounded-full bg-[#0bda5b]"></span><span id="overviewActiveClients" class="font-bold text-[#0bda5b]">--</span></span>
                        <span class="flex items-center gap-1"><span class="w-2 h-2 rounded-full bg-red-500"></span><span id="overviewProblemClients" class="font-bold text-red-500">--</span></span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Painel de Clientes (Airport Board) -->
        <div class="bg-surface-dark border border-border-dark rounded-xl sm:rounded-2xl overflow-hidden">
            <div class="overflow-x-auto">
                <div id="overviewBoard" class="min-w-[780px]">
                    <!-- Header Row -->
                    <div id="overviewBoardHeader" class="grid grid-cols-[20px_1fr_110px_70px_140px_110px_110px] gap-x-4 px-6 py-3.5 border-b-2 border-slate-700 text-[11px] uppercase tracking-wider text-slate-400 font-bold bg-background-dark">
                        <div></div>
                        <div class="board-sort-col cursor-pointer select-none flex items-center gap-1.5" data-sort="name">Cliente <span class="material-symbols-outlined text-base leading-none board-sort-icon">unfold_more</span></div>
                        <div class="board-sort-col cursor-pointer select-none flex items-center justify-end gap-1.5" data-sort="spend">Investido <span class="material-symbols-outlined text-base leading-none board-sort-icon">unfold_more</span></div>
                        <div class="board-sort-col cursor-pointer select-none flex items-center justify-end gap-1.5" data-sort="leads">Leads <span class="material-symbols-outlined text-base leading-none board-sort-icon">unfold_more</span></div>
                        <div class="board-sort-col cursor-pointer select-none flex items-center justify-end gap-1.5" data-sort="cpl">CPL <span class="material-symbols-outlined text-base leading-none board-sort-icon">unfold_more</span></div>
                        <div class="board-sort-col cursor-pointer select-none flex items-center justify-end gap-1.5" data-sort="balance">Saldo <span class="material-symbols-outlined text-base leading-none board-sort-icon">unfold_more</span></div>
                        <div class="text-center">Status</div>
                    </div>
                    <!-- Data Rows -->
                    <div id="overviewBoardRows">
                        <div id="overviewLoading" class="flex flex-col items-center justify-center py-16 text-slate-600">
                            <span class="material-symbols-outlined text-5xl sm:text-6xl mb-3 opacity-50">grid_view</span>
                            <span class="text-sm">Selecione Atualizar para carregar os dados</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Cards View Container (hidden by default) -->
        <div id="overviewCardsContainer" class="hidden">
            <div id="overviewCards" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4"></div>
        </div>

        <!-- Footer -->
        <div class="flex flex-col sm:flex-row items-center justify-between gap-3 text-[10px] sm:text-xs text-slate-600 font-medium pt-4">
            <p class="text-center sm:text-left">&copy; 2026 | Meta Ads | Desenvolvido por Alisson Gouveia. Todos os direitos reservados.</p>
            <div class="flex gap-4">
                <a class="hover:text-slate-400" href="#">Termos</a>
                <a class="hover:text-slate-400" href="#">Privacidade</a>
                <a class="hover:text-slate-400" href="#">Suporte</a>
            </div>
        </div>
    </div>

    <!-- Painel: Metricas (oculto por padrao) -->
    <div id="panelMetricas" class="hidden p-4 sm:p-6 lg:p-8 space-y-6 sm:space-y-8 max-w-7xl mx-auto w-full">
        <!-- Banner de Plataforma -->
        <div id="platformBanner" class="hidden items-center justify-between bg-surface-dark border border-border-dark rounded-xl sm:rounded-2xl px-4 sm:px-5 py-3">
            <div class="flex items-center gap-3">
                <svg class="w-6 h-6 shrink-0" viewBox="0 0 36 36" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <defs><linearGradient id="metaGrad" x1="0" y1="0" x2="36" y2="36"><stop offset="0%" stop-color="#0081FB"/><stop offset="100%" stop-color="#0064E0"/></linearGradient></defs>
                    <circle cx="18" cy="18" r="18" fill="url(#metaGrad)"/>
                    <path d="M25.2 12.6c-1.4 0-2.5 1.1-3.6 2.8l-1.6 2.5-1.6-2.5c-1.1-1.7-2.2-2.8-3.6-2.8-2.4 0-4.3 3.4-4.3 7.4s1.9 4.6 3.5 4.6c1.4 0 2.3-.7 3.8-3l1.6-2.6 1.6 2.6c1.5 2.3 2.4 3 3.8 3 1.6 0 3.5-.6 3.5-4.6s-1.9-7.4-4.3-7.4h.2zm-10.4 9.8c-.8 0-1.3-.6-1.3-2.4 0-2.4.9-5.1 2.1-5.1.7 0 1.4.8 2.3 2.2l.8 1.3c-1.4 2.3-2.5 4-3.9 4zm7.2 0c-1.4 0-2.5-1.7-3.9-4l.8-1.3c.9-1.4 1.6-2.2 2.3-2.2 1.2 0 2.1 2.7 2.1 5.1 0 1.8-.5 2.4-1.3 2.4z" fill="white"/>
                </svg>
                <div class="flex items-center gap-2">
                    <span class="text-sm font-bold text-white">Meta Ads</span>
                    <span class="hidden sm:inline text-[10px] text-slate-500 font-medium">Gerenciador de Anuncios</span>
                </div>
            </div>
            <a id="adsManagerLink" href="#" target="_blank" rel="noopener noreferrer"
               class="flex items-center gap-1.5 px-3 py-1.5 bg-blue-500/10 hover:bg-blue-500/20 border border-blue-500/20 hover:border-blue-500/40 text-blue-400 rounded-lg text-xs font-semibold transition-all">
                <span class="material-symbols-outlined text-sm">open_in_new</span>
                <span class="hidden sm:inline">Ver no Gerenciador</span>
            </a>
        </div>

        <!-- Cards de Metricas -->
        <div class="grid grid-cols-1 xs:grid-cols-2 lg:grid-cols-4 gap-4 sm:gap-6">
            <!-- Card Valor Investido -->
            <div class="bg-surface-dark border border-border-dark rounded-xl sm:rounded-2xl p-4 sm:p-6 shadow-sm hover:border-slate-700 transition-colors group">
                <div class="flex items-center justify-between mb-3 sm:mb-4">
                    <div class="w-8 h-8 sm:w-10 sm:h-10 bg-blue-500/10 rounded-lg sm:rounded-xl flex items-center justify-center text-blue-500 group-hover:bg-blue-500/20">
                        <span class="material-symbols-outlined text-xl sm:text-2xl">payments</span>
                    </div>
                    <div id="spendTrend" class="flex items-center gap-1 text-slate-500 bg-slate-500/10 px-1.5 sm:px-2 py-0.5 rounded text-[10px] sm:text-xs font-bold">
                        <span class="material-symbols-outlined text-[10px] sm:text-xs">remove</span>
                        <span>--</span>
                    </div>
                </div>
                <span class="text-[10px] sm:text-xs font-bold text-slate-500 uppercase tracking-widest">Valor Investido</span>
                <p id="spendValue" class="text-xl sm:text-2xl font-bold text-white mt-1">--</p>
                <span class="text-[8px] text-blue-500/30 font-bold uppercase tracking-widest mt-2 block">Meta Ads</span>
            </div>

            <!-- Card Impressoes -->
            <div class="bg-surface-dark border border-border-dark rounded-xl sm:rounded-2xl p-4 sm:p-6 shadow-sm hover:border-slate-700 transition-colors group">
                <div class="flex items-center justify-between mb-3 sm:mb-4">
                    <div class="w-8 h-8 sm:w-10 sm:h-10 bg-purple-500/10 rounded-lg sm:rounded-xl flex items-center justify-center text-purple-500 group-hover:bg-purple-500/20">
                        <span class="material-symbols-outlined text-xl sm:text-2xl">visibility</span>
                    </div>
                    <div id="impressionsTrend" class="flex items-center gap-1 text-slate-500 bg-slate-500/10 px-1.5 sm:px-2 py-0.5 rounded text-[10px] sm:text-xs font-bold">
                        <span class="material-symbols-outlined text-[10px] sm:text-xs">remove</span>
                        <span>--</span>
                    </div>
                </div>
                <span class="text-[10px] sm:text-xs font-bold text-slate-500 uppercase tracking-widest">Total de Impressoes</span>
                <p id="impressionsValue" class="text-xl sm:text-2xl font-bold text-white mt-1">--</p>
                <span class="text-[8px] text-blue-500/30 font-bold uppercase tracking-widest mt-2 block">Meta Ads</span>
            </div>

            <!-- Card Leads -->
            <div class="bg-surface-dark border border-border-dark rounded-xl sm:rounded-2xl p-4 sm:p-6 shadow-sm hover:border-slate-700 transition-colors group">
                <div class="flex items-center justify-between mb-3 sm:mb-4">
                    <div class="w-8 h-8 sm:w-10 sm:h-10 bg-orange-500/10 rounded-lg sm:rounded-xl flex items-center justify-center text-orange-500 group-hover:bg-orange-500/20">
                        <span class="material-symbols-outlined text-xl sm:text-2xl">person_add</span>
                    </div>
                    <div id="leadsTrend" class="flex items-center gap-1 text-slate-500 bg-slate-500/10 px-1.5 sm:px-2 py-0.5 rounded text-[10px] sm:text-xs font-bold">
                        <span class="material-symbols-outlined text-[10px] sm:text-xs">remove</span>
                        <span>--</span>
                    </div>
                </div>
                <span class="text-[10px] sm:text-xs font-bold text-slate-500 uppercase tracking-widest">Leads Gerados</span>
                <p id="leadsValue" class="text-xl sm:text-2xl font-bold text-white mt-1">--</p>
                <span class="text-[8px] text-blue-500/30 font-bold uppercase tracking-widest mt-2 block">Meta Ads</span>
            </div>

            <!-- Card CPL -->
            <div class="bg-surface-dark border border-border-dark rounded-xl sm:rounded-2xl p-4 sm:p-6 shadow-sm hover:border-slate-700 transition-colors group">
                <div class="flex items-center justify-between mb-3 sm:mb-4">
                    <div class="w-8 h-8 sm:w-10 sm:h-10 bg-primary/10 rounded-lg sm:rounded-xl flex items-center justify-center text-primary group-hover:bg-primary/20">
                        <span class="material-symbols-outlined text-xl sm:text-2xl">toll</span>
                    </div>
                    <div id="cplTrend" class="flex items-center gap-1 text-slate-500 bg-slate-500/10 px-1.5 sm:px-2 py-0.5 rounded text-[10px] sm:text-xs font-bold">
                        <span class="material-symbols-outlined text-[10px] sm:text-xs">remove</span>
                        <span>--</span>
                    </div>
                </div>
                <span class="text-[10px] sm:text-xs font-bold text-slate-500 uppercase tracking-widest">Custo por Lead</span>
                <div class="flex items-center gap-2 mt-1">
                    <p id="cplValue" class="text-xl sm:text-2xl font-bold text-white">--</p>
                    <span id="cplClassBadge" class="hidden"></span>
                </div>
                <span class="text-[8px] text-blue-500/30 font-bold uppercase tracking-widest mt-2 block">Meta Ads</span>
            </div>
        </div>

        <!-- Grafico de Performance -->
        <div class="bg-surface-dark border border-border-dark rounded-xl sm:rounded-2xl p-4 sm:p-6 lg:p-8 shadow-sm">
            <div class="flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-6 sm:mb-8">
                <div>
                    <h3 class="text-base sm:text-lg font-bold text-white tracking-tight">Analise de Performance</h3>
                    <p class="text-xs sm:text-sm text-slate-500 mt-1">Variacao das metricas principais no periodo selecionado</p>
                </div>
                <div class="flex items-center gap-1 p-1 bg-background-dark border border-border-dark rounded-lg chart-filters flex-wrap sm:flex-nowrap">
                    <button class="chart-filter-btn flex-1 sm:flex-initial text-center px-2 sm:px-4 py-1.5 rounded-md text-[10px] sm:text-xs font-bold bg-primary text-white shadow-lg transition-all" data-metric="spend"><span class="sm:hidden">Invest.</span><span class="hidden sm:inline">Valor Investido</span></button>
                    <button class="chart-filter-btn flex-1 sm:flex-initial text-center px-2 sm:px-4 py-1.5 rounded-md text-[10px] sm:text-xs font-bold text-slate-500 hover:text-white transition-all" data-metric="impressions"><span class="sm:hidden">Impr.</span><span class="hidden sm:inline">Impressoes</span></button>
                    <button class="chart-filter-btn flex-1 sm:flex-initial text-center px-2 sm:px-4 py-1.5 rounded-md text-[10px] sm:text-xs font-bold text-slate-500 hover:text-white transition-all" data-metric="leads">Leads</button>
                    <button class="chart-filter-btn flex-1 sm:flex-initial text-center px-2 sm:px-4 py-1.5 rounded-md text-[10px] sm:text-xs font-bold text-slate-500 hover:text-white transition-all" data-metric="cpl">CPL</button>
                </div>
            </div>
            <div id="chartContainer" class="relative h-[250px] sm:h-[300px] lg:h-[400px] w-full chart-grid rounded-xl border border-border-dark/50 overflow-visible">
                <!-- Placeholder inicial do grafico -->
                <div id="chartPlaceholder" class="flex flex-col items-center justify-center h-full text-slate-600">
                    <span class="material-symbols-outlined text-5xl sm:text-6xl mb-3 opacity-50">show_chart</span>
                    <span class="text-sm">Selecione um cliente para visualizar o grafico</span>
                </div>
            </div>
            <div id="chartLabels" class="hidden"></div>

            <!-- Barra de Abas: Campanhas / Criativos -->
            <div id="analysisTabBar" class="hidden mt-6">
                <div class="flex gap-1 p-1 bg-surface-dark border border-border-dark rounded-lg w-full sm:w-fit mx-auto">
                    <button id="tabCampaigns" onclick="switchAnalysisTab('campaigns')" class="analysis-tab-btn flex items-center justify-center gap-1.5 px-2.5 sm:px-4 py-1.5 sm:py-2 text-xs sm:text-sm font-semibold rounded-md transition-colors text-slate-400 hover:text-white flex-1 sm:flex-initial">
                        <span class="material-symbols-outlined text-base">campaign</span>
                        <span class="hidden sm:inline">Campanhas</span>
                    </button>
                    <button id="tabCreatives" onclick="switchAnalysisTab('creatives')" class="analysis-tab-btn flex items-center justify-center gap-1.5 px-2.5 sm:px-4 py-1.5 sm:py-2 text-xs sm:text-sm font-semibold rounded-md transition-colors text-slate-400 hover:text-white flex-1 sm:flex-initial">
                        <span class="material-symbols-outlined text-base">ads_click</span>
                        <span class="hidden sm:inline">Criativos</span>
                    </button>
                    <button id="tabAnalyst" onclick="switchAnalysisTab('analyst')" class="analysis-tab-btn flex items-center justify-center gap-1.5 px-2.5 sm:px-4 py-1.5 sm:py-2 text-xs sm:text-sm font-semibold rounded-md transition-colors text-slate-400 hover:text-white flex-1 sm:flex-initial">
                        <span class="material-symbols-outlined text-base">psychology</span>
                        <span class="hidden sm:inline">Analista</span>
                    </button>
                </div>
            </div>

            <!-- Container de Análise -->
            <div id="analysisSection" class="hidden mt-4">
                <div class="bg-surface-dark border border-border-dark rounded-xl sm:rounded-2xl p-4 sm:p-6 overflow-hidden">
                    <div id="analysisHeader" class="flex items-center justify-between mb-4">
                        <div id="analysisBreadcrumb" class="flex items-center gap-2 text-sm"></div>
                        <button onclick="closeAnalysis()" class="text-slate-400 hover:text-white transition-colors">
                            <span class="material-symbols-outlined">close</span>
                        </button>
                    </div>
                    <div id="analysisLoading" class="hidden flex items-center justify-center py-8">
                        <div class="w-8 h-8 border-[3px] border-blue-500/20 border-t-blue-500 rounded-full animate-spin"></div>
                    </div>
                    <div id="analysisContent"></div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="flex flex-col sm:flex-row items-center justify-between gap-3 text-[10px] sm:text-xs text-slate-600 font-medium pt-4">
            <p class="text-center sm:text-left">© 2026 | Meta Ads | Desenvolvido por Alisson Gouveia. Todos os direitos reservados.</p>
            <div class="flex gap-4">
                <a class="hover:text-slate-400" href="#">Termos</a>
                <a class="hover:text-slate-400" href="#">Privacidade</a>
                <a class="hover:text-slate-400" href="#">Suporte</a>
            </div>
        </div>
    </div>

    <!-- Painel: Relatorios (oculto por padrao) -->
    <div id="panelRelatorios" class="hidden p-4 sm:p-6 lg:p-8 space-y-6 sm:space-y-8 max-w-7xl mx-auto w-full">

        <!-- Configuracao do Relatorio -->
        <div class="bg-surface-dark border border-border-dark rounded-xl sm:rounded-2xl p-4 sm:p-6 lg:p-8 shadow-sm">
            <div class="mb-6">
                <h3 class="text-base sm:text-lg font-bold text-white tracking-tight">Gerar Relatorio</h3>
                <p class="text-xs sm:text-sm text-slate-500 mt-1">Configure e gere relatorios executivos em PDF</p>
            </div>

            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6">
                <!-- Selecao de Cliente -->
                <div>
                    <label class="block text-xs font-medium text-slate-400 mb-2">Cliente</label>
                    <div class="relative">
                        <select id="reportClientFilter" onchange="onReportClientChange()" class="w-full bg-background-dark border border-border-dark text-slate-300 rounded-lg py-2.5 px-3 text-sm appearance-none focus:ring-primary focus:border-primary hover:border-slate-600 transition-colors cursor-pointer">
                            <option value="">Selecione um Cliente</option>
                        </select>
                        <span class="material-symbols-outlined absolute right-3 top-1/2 -translate-y-1/2 text-slate-500 pointer-events-none text-base">expand_more</span>
                    </div>
                </div>

                <!-- Periodo -->
                <div>
                    <label class="block text-xs font-medium text-slate-400 mb-2">Periodo</label>
                    <div class="relative">
                        <select id="reportPeriodFilter" onchange="onReportPeriodChange()" class="w-full bg-background-dark border border-border-dark text-slate-300 rounded-lg py-2.5 px-3 text-sm appearance-none focus:ring-primary focus:border-primary hover:border-slate-600 transition-colors cursor-pointer">
                            <option value="last_7d" selected>Ultimos 7 dias</option>
                            <option value="last_14d">Ultimos 14 dias</option>
                            <option value="last_28d">Ultimos 28 dias</option>
                            <option value="last_30d">Ultimos 30 dias</option>
                            <option value="this_week">Esta semana</option>
                            <option value="last_week">Semana passada</option>
                            <option value="this_month">Este mes</option>
                            <option value="last_month">Mes passado</option>
                        </select>
                        <span class="material-symbols-outlined absolute right-3 top-1/2 -translate-y-1/2 text-slate-500 pointer-events-none text-base">expand_more</span>
                    </div>
                </div>

                <!-- Versao -->
                <div>
                    <label class="block text-xs font-medium text-slate-400 mb-2">Versao</label>
                    <div class="relative">
                        <select id="reportVersionFilter" class="w-full bg-background-dark border border-border-dark text-slate-300 rounded-lg py-2.5 px-3 text-sm appearance-none focus:ring-primary focus:border-primary hover:border-slate-600 transition-colors cursor-pointer">
                            <option value="simplified">Simplificada (Cliente)</option>
                            <option value="complete">Completa (Interna)</option>
                        </select>
                        <span class="material-symbols-outlined absolute right-3 top-1/2 -translate-y-1/2 text-slate-500 pointer-events-none text-base">expand_more</span>
                    </div>
                </div>

                <!-- Botoes Gerar -->
                <div class="flex items-end gap-2">
                    <button id="generateReportBtn" onclick="generateReport()" class="flex-1 flex items-center justify-center gap-2 py-2.5 px-4 bg-primary text-white rounded-lg text-sm font-bold hover:bg-primary/90 transition-colors disabled:opacity-50 disabled:cursor-not-allowed" disabled>
                        <span class="material-symbols-outlined text-lg">analytics</span>
                        Relatorio
                    </button>
                    <!-- Analise Macro desabilitada temporariamente - feature em desenvolvimento -->
                    <!--
                    <button id="generateMacroBtn" onclick="generateMacroAnalysis()" class="flex-1 flex items-center justify-center gap-2 py-2.5 px-4 bg-blue-500 text-white rounded-lg text-sm font-bold hover:bg-blue-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed" disabled>
                        <span class="material-symbols-outlined text-lg">query_stats</span>
                        Analise Macro
                    </button>
                    -->
                </div>
            </div>

            <!-- Info do periodo -->
            <div id="reportPeriodInfo" class="mt-4 p-3 bg-background-dark border border-border-dark rounded-lg hidden">
                <div class="flex items-start gap-2 text-xs text-slate-400">
                    <span class="material-symbols-outlined text-primary text-base shrink-0 mt-0.5">info</span>
                    <span id="reportPeriodText"></span>
                </div>
            </div>
        </div>

        <!-- Progresso da Geracao -->
        <div id="reportProgress" class="hidden bg-surface-dark border border-border-dark rounded-xl sm:rounded-2xl p-4 sm:p-6 lg:p-8 shadow-sm">
            <div class="flex items-center gap-4 mb-4">
                <div class="w-10 h-10 border-3 border-primary/20 border-t-primary rounded-full animate-spin shrink-0"></div>
                <div>
                    <h3 class="text-sm font-bold text-white">Gerando Relatorio...</h3>
                    <p id="reportProgressText" class="text-xs text-slate-500 mt-0.5">Buscando dados da semana...</p>
                </div>
            </div>
            <div class="w-full bg-background-dark rounded-full h-2">
                <div id="reportProgressBar" class="bg-primary h-2 rounded-full transition-all duration-300" style="width: 0%"></div>
            </div>
        </div>

        <!-- Preview do Relatorio (renderizado via JS) -->
        <div id="reportPreview" class="hidden space-y-4">
            <!-- Conteudo gerado por renderReportPreview() -->
        </div>

        <!-- Progresso da Analise Macro -->
        <div id="macroAnalysisProgress" class="hidden bg-surface-dark border border-border-dark rounded-xl sm:rounded-2xl p-4 sm:p-6 lg:p-8 shadow-sm">
            <div class="flex items-center gap-4 mb-4">
                <div class="w-10 h-10 border-3 border-blue-500/20 border-t-blue-500 rounded-full animate-spin shrink-0"></div>
                <div>
                    <h3 class="text-sm font-bold text-white">Gerando Analise Macro...</h3>
                    <p id="macroProgressText" class="text-xs text-slate-500 mt-0.5">Buscando dados da conta...</p>
                </div>
            </div>
            <div class="w-full bg-background-dark rounded-full h-2">
                <div id="macroProgressBar" class="bg-blue-500 h-2 rounded-full transition-all duration-300" style="width: 0%"></div>
            </div>
        </div>

        <!-- Resultado da Analise Macro -->
        <div id="macroAnalysisResult" class="hidden space-y-4">
            <!-- Conteudo gerado por renderMacroAnalysis() -->
        </div>

        <!-- Envio Automatico -->
        <div class="bg-surface-dark border border-border-dark rounded-xl sm:rounded-2xl p-4 sm:p-6 lg:p-8 shadow-sm">
            <div class="mb-6">
                <div class="flex items-center gap-2 mb-1">
                    <span class="material-symbols-outlined text-primary text-lg">schedule_send</span>
                    <h3 class="text-base sm:text-lg font-bold text-white tracking-tight">Envio Automatico</h3>
                </div>
                <p class="text-xs sm:text-sm text-slate-500 mt-1">Configure o envio automatico de relatorios para o Google Chat</p>
            </div>

            <!-- Selecao de cliente -->
            <div class="mb-5">
                <label class="block text-xs font-medium text-slate-400 mb-2">Cliente</label>
                <div class="relative max-w-xs">
                    <select id="scheduleClientFilter" onchange="onScheduleClientChange()" class="w-full bg-background-dark border border-border-dark text-slate-300 rounded-lg py-2.5 px-3 text-sm appearance-none focus:ring-primary focus:border-primary hover:border-slate-600 transition-colors cursor-pointer">
                        <option value="">Selecione um Cliente</option>
                    </select>
                    <span class="material-symbols-outlined absolute right-3 top-1/2 -translate-y-1/2 text-slate-500 pointer-events-none text-base">expand_more</span>
                </div>
            </div>

            <!-- Container de regras (renderizado via JS) -->
            <div id="scheduleRulesContainer" class="hidden">
                <!-- Mensagem se nao tem webhook -->
                <div id="scheduleNoWebhook" class="hidden text-center py-6">
                    <span class="material-symbols-outlined text-slate-600 text-3xl mb-2">link_off</span>
                    <p class="text-sm text-slate-500">Este cliente nao possui webhook configurado.</p>
                    <p class="text-xs text-slate-600 mt-1">Adicione o webhook no cadastro do cliente (Gerenciar Clientes).</p>
                </div>

                <!-- Regras de envio -->
                <div id="scheduleRules" class="space-y-3 mb-4">
                    <!-- Regras renderizadas via JS -->
                </div>

                <!-- Botao adicionar regra -->
                <button id="scheduleAddRuleBtn" onclick="addScheduleRule()" class="hidden flex items-center gap-2 px-3 py-2 text-xs font-medium text-slate-400 hover:text-white hover:bg-surface-dark border border-dashed border-border-dark rounded-lg transition-colors w-full justify-center">
                    <span class="material-symbols-outlined text-sm">add</span>
                    Adicionar regra de envio
                </button>

                <!-- Acoes -->
                <div id="scheduleActions" class="hidden flex flex-wrap items-center gap-3 mt-5 pt-4 border-t border-border-dark">
                    <button onclick="saveScheduleConfig()" class="flex items-center gap-2 py-2.5 px-4 bg-primary text-white rounded-lg text-sm font-bold hover:bg-primary/90 transition-colors">
                        <span class="material-symbols-outlined text-lg">save</span>
                        Salvar configuracao
                    </button>
                    <button onclick="sendTestReport()" class="flex items-center gap-2 py-2.5 px-4 bg-surface-dark border border-border-dark text-slate-300 rounded-lg text-sm font-medium hover:bg-slate-800 transition-colors">
                        <span class="material-symbols-outlined text-lg">send</span>
                        Enviar agora (teste)
                    </button>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="flex flex-col sm:flex-row items-center justify-between gap-3 text-[10px] sm:text-xs text-slate-600 font-medium pt-4">
            <p class="text-center sm:text-left">&copy; 2026 | Meta Ads | Desenvolvido por Alisson Gouveia. Todos os direitos reservados.</p>
            <div class="flex gap-4">
                <a class="hover:text-slate-400" href="#">Termos</a>
                <a class="hover:text-slate-400" href="#">Privacidade</a>
                <a class="hover:text-slate-400" href="#">Suporte</a>
            </div>
        </div>
    </div>

</main>

<!-- Modal de Senha -->
<div id="passwordModal" class="fixed inset-0 z-50 hidden items-center justify-center p-4">
    <!-- Overlay -->
    <div class="absolute inset-0 bg-black/60 backdrop-blur-sm" onclick="closePasswordModal()"></div>

    <!-- Modal Content -->
    <div class="relative bg-surface-dark border border-border-dark rounded-2xl w-full max-w-sm p-6 shadow-2xl transform transition-all">
        <!-- Header -->
        <div class="text-center mb-6">
            <div class="w-14 h-14 bg-primary/10 rounded-full flex items-center justify-center mx-auto mb-4">
                <span class="material-symbols-outlined text-primary text-3xl">lock</span>
            </div>
            <h2 class="text-xl font-bold text-white">Acesso Restrito</h2>
            <p class="text-sm text-slate-500 mt-1">Digite a senha para acessar as configuracoes</p>
        </div>

        <!-- Form -->
        <form onsubmit="validatePassword(event)">
            <div class="mb-4">
                <label class="block text-xs font-medium text-slate-400 mb-2">Senha</label>
                <div class="relative">
                    <input
                        type="password"
                        id="passwordInput"
                        class="w-full bg-background-dark border border-border-dark text-white rounded-lg py-3 px-4 pr-12 text-sm focus:ring-2 focus:ring-primary focus:border-primary transition-colors"
                        placeholder="Digite sua senha"
                        autocomplete="off"
                    >
                    <button
                        type="button"
                        onclick="togglePasswordVisibility()"
                        class="absolute right-3 top-1/2 -translate-y-1/2 text-slate-500 hover:text-white transition-colors"
                    >
                        <span class="material-symbols-outlined text-xl" id="passwordToggleIcon">visibility</span>
                    </button>
                </div>
                <p id="passwordError" class="text-red-500 text-xs mt-2 hidden">Senha incorreta. Tente novamente.</p>
            </div>

            <div class="flex gap-3">
                <button
                    type="button"
                    onclick="closePasswordModal()"
                    class="flex-1 py-3 px-4 bg-background-dark border border-border-dark text-slate-300 rounded-lg text-sm font-medium hover:bg-slate-800 transition-colors"
                >
                    Cancelar
                </button>
                <button
                    type="submit"
                    class="flex-1 py-3 px-4 bg-primary text-white rounded-lg text-sm font-bold hover:bg-primary/90 transition-colors"
                >
                    Entrar
                </button>
            </div>
        </form>
    </div>
</div>

</div>
<!-- Fim Dashboard Container -->

<!-- Modal de Filtro de Periodo -->
<div id="dateFilterModal" class="fixed inset-0 z-50 hidden items-center justify-center p-2 sm:p-4">
    <!-- Overlay -->
    <div class="absolute inset-0 bg-black/60 backdrop-blur-sm" onclick="closeDateFilterModal()"></div>

    <!-- Modal Content -->
    <div class="relative bg-surface-dark border border-border-dark rounded-2xl w-full max-w-md max-h-[90vh] shadow-2xl transform transition-all flex flex-col overflow-hidden">
        <!-- Header -->
        <div class="flex items-center justify-between p-4 border-b border-border-dark">
            <div class="flex items-center gap-3">
                <div class="w-10 h-10 bg-primary/10 rounded-xl flex items-center justify-center">
                    <span class="material-symbols-outlined text-primary">date_range</span>
                </div>
                <div>
                    <h2 class="text-lg font-bold text-white">Periodo</h2>
                    <p class="text-xs text-slate-500">Selecione o periodo de analise</p>
                </div>
            </div>
            <button onclick="closeDateFilterModal()" class="p-2 text-slate-400 hover:text-white hover:bg-background-dark rounded-lg transition-colors">
                <span class="material-symbols-outlined">close</span>
            </button>
        </div>

        <!-- Content -->
        <div class="p-4 overflow-y-auto flex-1">
            <!-- Periodos Pre-definidos -->
            <div class="grid grid-cols-2 gap-2 mb-4">
                <button onclick="selectDatePreset('today', 'Hoje')" class="date-preset-btn flex items-center gap-2 p-3 sm:p-3 bg-background-dark border border-border-dark rounded-xl text-xs sm:text-sm text-slate-300 hover:border-primary hover:text-white active:scale-95 transition-all text-left">
                    <span class="material-symbols-outlined text-base sm:text-lg text-slate-500">today</span>
                    Hoje
                </button>
                <button onclick="selectDatePreset('yesterday', 'Ontem')" class="date-preset-btn flex items-center gap-2 p-3 sm:p-3 bg-background-dark border border-border-dark rounded-xl text-xs sm:text-sm text-slate-300 hover:border-primary hover:text-white active:scale-95 transition-all text-left">
                    <span class="material-symbols-outlined text-base sm:text-lg text-slate-500">event</span>
                    Ontem
                </button>
                <button onclick="selectDatePreset('last_7d', 'Ultimos 7 dias')" class="date-preset-btn flex items-center gap-2 p-3 sm:p-3 bg-background-dark border border-border-dark rounded-xl text-xs sm:text-sm text-slate-300 hover:border-primary hover:text-white active:scale-95 transition-all text-left">
                    <span class="material-symbols-outlined text-base sm:text-lg text-slate-500">date_range</span>
                    Ultimos 7 dias
                </button>
                <button onclick="selectDatePreset('last_14d', 'Ultimos 14 dias')" class="date-preset-btn flex items-center gap-2 p-3 sm:p-3 bg-background-dark border border-border-dark rounded-xl text-xs sm:text-sm text-slate-300 hover:border-primary hover:text-white active:scale-95 transition-all text-left">
                    <span class="material-symbols-outlined text-base sm:text-lg text-slate-500">date_range</span>
                    Ultimos 14 dias
                </button>
                <button onclick="selectDatePreset('last_28d', 'Ultimos 28 dias')" class="date-preset-btn flex items-center gap-2 p-3 sm:p-3 bg-background-dark border border-border-dark rounded-xl text-xs sm:text-sm text-slate-300 hover:border-primary hover:text-white active:scale-95 transition-all text-left">
                    <span class="material-symbols-outlined text-base sm:text-lg text-slate-500">date_range</span>
                    Ultimos 28 dias
                </button>
                <button onclick="selectDatePreset('last_30d', 'Ultimos 30 dias')" class="date-preset-btn flex items-center gap-2 p-3 sm:p-3 bg-background-dark border border-border-dark rounded-xl text-xs sm:text-sm text-slate-300 hover:border-primary hover:text-white active:scale-95 transition-all text-left">
                    <span class="material-symbols-outlined text-base sm:text-lg text-slate-500">date_range</span>
                    Ultimos 30 dias
                </button>
                <button onclick="selectDatePreset('this_week', 'Esta semana')" class="date-preset-btn flex items-center gap-2 p-3 sm:p-3 bg-background-dark border border-border-dark rounded-xl text-xs sm:text-sm text-slate-300 hover:border-primary hover:text-white active:scale-95 transition-all text-left">
                    <span class="material-symbols-outlined text-base sm:text-lg text-slate-500">view_week</span>
                    Esta semana
                </button>
                <button onclick="selectDatePreset('last_week', 'Semana passada')" class="date-preset-btn flex items-center gap-2 p-3 sm:p-3 bg-background-dark border border-border-dark rounded-xl text-xs sm:text-sm text-slate-300 hover:border-primary hover:text-white active:scale-95 transition-all text-left">
                    <span class="material-symbols-outlined text-base sm:text-lg text-slate-500">view_week</span>
                    Semana passada
                </button>
                <button onclick="selectDatePreset('this_month', 'Este mes')" class="date-preset-btn flex items-center gap-2 p-3 sm:p-3 bg-background-dark border border-border-dark rounded-xl text-xs sm:text-sm text-slate-300 hover:border-primary hover:text-white active:scale-95 transition-all text-left">
                    <span class="material-symbols-outlined text-base sm:text-lg text-slate-500">calendar_month</span>
                    Este mes
                </button>
                <button onclick="selectDatePreset('last_month', 'Mes passado')" class="date-preset-btn flex items-center gap-2 p-3 sm:p-3 bg-background-dark border border-border-dark rounded-xl text-xs sm:text-sm text-slate-300 hover:border-primary hover:text-white active:scale-95 transition-all text-left">
                    <span class="material-symbols-outlined text-base sm:text-lg text-slate-500">calendar_month</span>
                    Mes passado
                </button>
                <button onclick="selectDatePreset('maximum', 'Maximo')" class="date-preset-btn flex items-center gap-2 p-3 sm:p-3 bg-background-dark border border-border-dark rounded-xl text-xs sm:text-sm text-slate-300 hover:border-primary hover:text-white active:scale-95 transition-all text-left col-span-2">
                    <span class="material-symbols-outlined text-base sm:text-lg text-slate-500">all_inclusive</span>
                    Maximo (todos os dados)
                </button>
            </div>

            <!-- Separador -->
            <div class="flex items-center gap-3 my-4">
                <div class="flex-1 h-px bg-border-dark"></div>
                <span class="text-xs text-slate-500">ou selecione um periodo</span>
                <div class="flex-1 h-px bg-border-dark"></div>
            </div>

            <!-- Periodo Personalizado -->
            <div class="bg-background-dark border border-border-dark rounded-xl p-4">
                <h3 class="text-sm font-bold text-white mb-3 flex items-center gap-2">
                    <span class="material-symbols-outlined text-primary text-lg">edit_calendar</span>
                    Periodo Personalizado
                </h3>
                <div class="grid grid-cols-2 gap-3">
                    <div>
                        <label class="block text-xs font-medium text-slate-400 mb-1.5">Data Inicio</label>
                        <input
                            type="date"
                            id="customDateStart"
                            class="w-full bg-surface-dark border border-border-dark text-white rounded-lg py-2.5 px-3 text-sm focus:ring-2 focus:ring-primary focus:border-primary transition-colors"
                        >
                    </div>
                    <div>
                        <label class="block text-xs font-medium text-slate-400 mb-1.5">Data Fim</label>
                        <input
                            type="date"
                            id="customDateEnd"
                            class="w-full bg-surface-dark border border-border-dark text-white rounded-lg py-2.5 px-3 text-sm focus:ring-2 focus:ring-primary focus:border-primary transition-colors"
                        >
                    </div>
                </div>
                <button onclick="applyCustomDateRange()" class="w-full mt-3 py-2.5 px-4 bg-primary text-white rounded-lg text-sm font-medium hover:bg-primary/90 transition-colors flex items-center justify-center gap-2">
                    <span class="material-symbols-outlined text-lg">check</span>
                    Aplicar Periodo
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Modal de Cadastro de Clientes -->
<div id="clientsModal" class="fixed inset-0 z-50 hidden items-center justify-center p-4">
    <!-- Overlay -->
    <div class="absolute inset-0 bg-black/60 backdrop-blur-sm" onclick="closeClientsModal()"></div>

    <!-- Modal Content -->
    <div class="relative bg-surface-dark border border-border-dark rounded-2xl w-full max-w-2xl max-h-[90vh] overflow-hidden shadow-2xl transform transition-all flex flex-col">
        <!-- Header -->
        <div class="flex items-center justify-between p-6 border-b border-border-dark shrink-0">
            <div class="flex items-center gap-3">
                <div class="w-10 h-10 bg-primary/10 rounded-xl flex items-center justify-center">
                    <span class="material-symbols-outlined text-primary">group_add</span>
                </div>
                <div>
                    <h2 class="text-lg font-bold text-white">Gerenciar Clientes</h2>
                    <p class="text-xs text-slate-500">Adicione e gerencie contas de anuncios</p>
                </div>
            </div>
            <button onclick="closeClientsModal()" class="p-2 text-slate-400 hover:text-white hover:bg-background-dark rounded-lg transition-colors">
                <span class="material-symbols-outlined">close</span>
            </button>
        </div>

        <!-- Content -->
        <div class="p-6 overflow-y-auto flex-1">
            <!-- Formulario de Adicionar Cliente -->
            <div class="bg-background-dark border border-border-dark rounded-xl p-4 mb-6">
                <h3 class="text-sm font-bold text-white mb-4 flex items-center gap-2">
                    <span class="material-symbols-outlined text-primary text-lg" id="formTitleIcon">add_circle</span>
                    <span id="formTitle">Adicionar Novo Cliente</span>
                </h3>
                <form onsubmit="addClient(event)" class="space-y-4">
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-xs font-medium text-slate-400 mb-1.5">Nome do Cliente</label>
                            <input
                                type="text"
                                id="clientName"
                                class="w-full bg-surface-dark border border-border-dark text-white rounded-lg py-2.5 px-3 text-sm focus:ring-2 focus:ring-primary focus:border-primary transition-colors"
                                placeholder="Ex: Imobiliaria ABC"
                                required
                            >
                        </div>
                        <div>
                            <label class="block text-xs font-medium text-slate-400 mb-1.5">ID da Conta de Anuncios</label>
                            <input
                                type="text"
                                id="adAccountId"
                                class="w-full bg-surface-dark border border-border-dark text-white rounded-lg py-2.5 px-3 text-sm focus:ring-2 focus:ring-primary focus:border-primary transition-colors"
                                placeholder="Ex: act_123456789"
                                required
                            >
                        </div>
                    </div>
                    <!-- Webhook Google Chat -->
                    <div class="sm:col-span-2">
                        <label class="block text-xs font-medium text-slate-400 mb-1.5">Webhook Google Chat (opcional)</label>
                        <div class="relative">
                            <span class="material-symbols-outlined absolute left-3 top-1/2 -translate-y-1/2 text-slate-600 text-base">chat</span>
                            <input
                                type="url"
                                id="googleChatWebhook"
                                class="w-full bg-surface-dark border border-border-dark text-white rounded-lg py-2.5 pl-9 pr-3 text-sm focus:ring-2 focus:ring-primary focus:border-primary transition-colors"
                                placeholder="https://chat.googleapis.com/v1/spaces/..."
                            >
                        </div>
                        <p class="text-[10px] text-slate-600 mt-1">Cole a URL do webhook do espaco do cliente para receber relatorios automaticos</p>
                    </div>
                    <!-- Faixas de CPL -->
                    <div class="border border-border-dark rounded-lg overflow-hidden">
                        <button type="button" onclick="toggleCplBands()" class="w-full flex items-center justify-between px-3 py-2.5 text-xs font-medium text-slate-400 hover:text-white hover:bg-surface-dark transition-colors">
                            <span class="flex items-center gap-2">
                                <span class="material-symbols-outlined text-sm">tune</span>
                                Faixas de CPL (classificacao)
                            </span>
                            <span class="material-symbols-outlined text-sm transition-transform" id="cplBandsArrow">expand_more</span>
                        </button>
                        <div id="cplBandsSection" class="hidden px-3 pb-3 space-y-2">
                            <p class="text-[11px] text-slate-500 mb-2">Defina os intervalos de CPL para cada faixa de desempenho.</p>

                            <!-- Excelente -->
                            <div class="flex items-center gap-2">
                                <span class="w-2 h-2 bg-emerald-400 rounded-full shrink-0"></span>
                                <span class="text-[11px] font-medium text-emerald-400 w-[70px] shrink-0">Excelente</span>
                                <span class="text-[11px] text-slate-500 shrink-0">CPL &le;</span>
                                <span class="text-[11px] text-slate-500 shrink-0 cpl-currency-symbol">R$</span>
                                <input type="number" id="cplExcellent" step="0.01" min="0"
                                    class="w-20 bg-surface-dark border border-border-dark text-white rounded py-1 px-2 text-xs text-center focus:ring-1 focus:ring-emerald-500 focus:border-emerald-500 transition-colors"
                                    placeholder="15">
                            </div>

                            <!-- Saudavel -->
                            <div class="flex items-center gap-2">
                                <span class="w-2 h-2 bg-blue-400 rounded-full shrink-0"></span>
                                <span class="text-[11px] font-medium text-blue-400 w-[70px] shrink-0">Saudavel</span>
                                <span class="text-[11px] text-slate-500 shrink-0">CPL &le;</span>
                                <span class="text-[11px] text-slate-500 shrink-0 cpl-currency-symbol">R$</span>
                                <input type="number" id="cplHealthy" step="0.01" min="0"
                                    class="w-20 bg-surface-dark border border-border-dark text-white rounded py-1 px-2 text-xs text-center focus:ring-1 focus:ring-blue-500 focus:border-blue-500 transition-colors"
                                    placeholder="25">
                            </div>

                            <!-- Atencao -->
                            <div class="flex items-center gap-2">
                                <span class="w-2 h-2 bg-amber-400 rounded-full shrink-0"></span>
                                <span class="text-[11px] font-medium text-amber-400 w-[70px] shrink-0">Atencao</span>
                                <span class="text-[11px] text-slate-500 shrink-0">CPL &le;</span>
                                <span class="text-[11px] text-slate-500 shrink-0 cpl-currency-symbol">R$</span>
                                <input type="number" id="cplWarning" step="0.01" min="0"
                                    class="w-20 bg-surface-dark border border-border-dark text-white rounded py-1 px-2 text-xs text-center focus:ring-1 focus:ring-amber-500 focus:border-amber-500 transition-colors"
                                    placeholder="40">
                            </div>

                            <!-- Critico -->
                            <div class="flex items-center gap-2">
                                <span class="w-2 h-2 bg-red-400 rounded-full shrink-0"></span>
                                <span class="text-[11px] font-medium text-red-400 w-[70px] shrink-0">Critico</span>
                                <span class="text-[11px] text-slate-500">acima do valor de Atencao</span>
                            </div>

                            <!-- Exemplo visual -->
                            <div id="cplPreview" class="mt-2 hidden">
                                <div class="flex h-2 rounded-full overflow-hidden">
                                    <div class="bg-emerald-500 flex-1"></div>
                                    <div class="bg-blue-500 flex-1"></div>
                                    <div class="bg-amber-500 flex-1"></div>
                                    <div class="bg-red-500 flex-1"></div>
                                </div>
                                <div class="flex justify-between text-[9px] text-slate-500 mt-0.5 px-0.5">
                                    <span class="cpl-currency-symbol">R$</span>
                                    <span id="cplPreviewExcellent"></span>
                                    <span id="cplPreviewHealthy"></span>
                                    <span id="cplPreviewWarning"></span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="flex justify-end gap-2">
                        <button
                            type="button"
                            id="formCancelBtn"
                            onclick="cancelEditClient()"
                            class="hidden flex items-center gap-2 py-2.5 px-4 bg-surface-dark border border-border-dark text-slate-300 rounded-lg text-sm font-medium hover:bg-slate-800 transition-colors"
                        >
                            <span class="material-symbols-outlined text-lg">close</span>
                            Cancelar
                        </button>
                        <button
                            type="submit"
                            id="formSubmitBtn"
                            class="flex items-center gap-2 py-2.5 px-4 bg-primary text-white rounded-lg text-sm font-medium hover:bg-primary/90 transition-colors"
                        >
                            <span class="material-symbols-outlined text-lg">add</span>
                            Adicionar Cliente
                        </button>
                    </div>
                </form>
            </div>

            <!-- Lista de Clientes -->
            <div>
                <h3 class="text-sm font-bold text-white mb-4 flex items-center gap-2">
                    <span class="material-symbols-outlined text-lg">list</span>
                    Clientes Cadastrados
                </h3>
                <div id="clientsList" class="space-y-3">
                    <!-- Clientes serao carregados do LocalStorage -->

                    <!-- Mensagem quando nao ha clientes -->
                    <div id="noClientsMessage" class="text-center py-8">
                        <div class="w-16 h-16 bg-surface-dark rounded-full flex items-center justify-center mx-auto mb-4">
                            <span class="material-symbols-outlined text-slate-600 text-3xl">person_off</span>
                        </div>
                        <p class="text-slate-500 text-sm">Nenhum cliente cadastrado</p>
                        <p class="text-slate-600 text-xs mt-1">Adicione seu primeiro cliente acima</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="p-4 border-t border-border-dark bg-background-dark/50 shrink-0">
            <div class="flex items-center justify-between">
                <p class="text-xs text-slate-500">
                    <span class="material-symbols-outlined text-sm align-middle mr-1">info</span>
                    O ID da conta pode ser encontrado no Gerenciador de Anuncios do Meta
                </p>
                <button onclick="closeClientsModal()" class="py-2 px-4 bg-surface-dark border border-border-dark text-slate-300 rounded-lg text-sm font-medium hover:bg-slate-800 transition-colors">
                    Fechar
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Modal de Detalhes do Criativo -->
<div id="creativeDetailModal" class="hidden fixed inset-0 z-[60] flex items-center justify-center p-4" onclick="if(event.target===this)closeCreativeModal()">
    <div class="absolute inset-0 bg-black/70 backdrop-blur-sm"></div>
    <div class="relative bg-surface-dark border border-border-dark rounded-2xl w-full max-w-3xl max-h-[90vh] overflow-y-auto hide-scrollbar">
        <!-- Header -->
        <div class="sticky top-0 z-10 bg-surface-dark border-b border-border-dark px-5 py-4 flex items-center justify-between">
            <div class="flex items-center gap-3 min-w-0">
                <div id="creativeModalThumb" class="w-10 h-10 rounded-lg overflow-hidden shrink-0"></div>
                <div class="min-w-0">
                    <p id="creativeModalName" class="text-sm font-bold text-white truncate"></p>
                    <p id="creativeModalMeta" class="text-[11px] text-slate-400"></p>
                </div>
            </div>
            <button onclick="closeCreativeModal()" class="text-slate-400 hover:text-white transition-colors shrink-0 ml-3">
                <span class="material-symbols-outlined">close</span>
            </button>
        </div>
        <!-- KPIs resumo -->
        <div id="creativeModalKpis" class="grid grid-cols-2 sm:grid-cols-4 gap-3 px-5 py-4 border-b border-border-dark/50"></div>
        <!-- Gráficos -->
        <div id="creativeModalCharts" class="px-5 py-4 space-y-5">
            <div class="flex items-center justify-center py-12">
                <div class="w-8 h-8 border-[3px] border-blue-500/20 border-t-blue-500 rounded-full animate-spin"></div>
            </div>
        </div>
    </div>
</div>

</body>
</html>
